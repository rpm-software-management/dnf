SHELL = @SHELL@
top_srcdir = @top_srcdir@
srcdir = @top_srcdir@
prefix = @prefix@
exec_prefix = @exec_prefix@

bindir = @bindir@
sbindir = @sbindir@
libexecdir = @libexecdir@
datadir = @datadir@
sysconfdir = @sysconfdir@
sharedstatedir = @sharedstatedir@
localstatedir = @localstatedir@
libdir = @libdir@
infodir = @infodir@
docdir = @docdir@
includedir = @includedir@
oldincludedir = @oldincludedir@
mandir = @mandir@

pkgdocdir = $(docdir)/@PACKAGE@-@VERSION@
pkgdatadir = $(datadir)/@PACKAGE@
pkglibdir = $(libdir)/@PACKAGE@
pkgincludedir = $(includedir)/@PACKAGE@

top_builddir = @top_builddir@
PACKAGE = @PACKAGE@
VERSION = @VERSION@
INSTALL = @INSTALL@
INSTALL_PROGRAM = @INSTALL_PROGRAM@
INSTALL_DATA = @INSTALL_DATA@
INSTALL_SCRIPT = @INSTALL_SCRIPT@

SUBDIRS = bin etc docs po

MODULES = $(srcdir)/pullheaders.pyc \
	  $(srcdir)/config.pyc \
	  $(srcdir)/nevral.pyc \
	  $(srcdir)/logger.pyc \
	  $(srcdir)/yumlock.pyc \
	  $(srcdir)/yummain.pyc \
	  $(srcdir)/i18n.pyc \
	  $(srcdir)/pkgaction.pyc \
	  $(srcdir)/serverStuff.pyc \
	  $(srcdir)/archwork.pyc \
	  $(srcdir)/callback.pyc \
	  $(srcdir)/clientStuff.pyc \
	  $(srcdir)/iutil.pyc \
	  $(srcdir)/lilocfg.pyc \
	  $(srcdir)/lilo.pyc \
	  $(srcdir)/grubcfg.pyc \
	  $(srcdir)/checkbootloader.pyc \
	  $(srcdir)/bootloadercfg.pyc \
	  $(srcdir)/up2datetheft.pyc \
	  $(srcdir)/keepalive.pyc \
	  $(srcdir)/urlgrabber.pyc \
	  $(srcdir)/progress_meter.pyc \
	  $(srcdir)/yumcomps.pyc \
	  $(srcdir)/failover.pyc \
	  $(srcdir)/comps.pyc \
	  $(srcdir)/rpmUtils.pyc 

.SUFFIXES: .py .pyc
.py.pyc: 
	./py-compile $*.py


all: $(MODULES)
	for subdir in $(SUBDIRS) ; do \
	  $(MAKE) -C $$subdir ; \
	done


install: all installdirs
	for module in $(MODULES) ; do \
	  $(INSTALL_DATA) $(srcdir)/$$module $(DESTDIR)$(pkgdatadir) ; \
	done
	for subdir in $(SUBDIRS) ; do \
	  $(MAKE) -C $$subdir install ; \
	done

uninstall:
	for module in $(MODULES) ; do \
	  $(RM) $(pkgdatadir)/$$module ; \
	done
	for subdir in $(SUBDIRS) ; do \
	  $(MAKE) -C $$subdir uninstall ; \
	done

clean:
	rm -f *.pyc *.pyo
	for subdir in $(SUBDIRS) ; do \
	  $(MAKE) -C $$subdir clean ; \
	done

distclean: clean
	$(RM) $(srcdir)/config.log
	$(RM) $(srcdir)/config.cache
	$(RM) $(srcdir)/Makefile
	$(RM) $(srcdir)/config.status
	$(RM) -rf .libs
	$(RM) -f core
	for subdir in $(SUBDIRS) ; do \
	  $(MAKE) -C $$subdir distclean ; \
	done

mostlyclean:
	$(MAKE) clean


maintainer-clean:
	$(MAKE) distclean
	$(RM) $(srcdir)/configure


dist:
	olddir=`pwd`; \
	distdir=$(PACKAGE)-$(VERSION); \
	rm -rf .disttmp; \
	mkdir .disttmp; \
	mkdir .disttmp/$$distdir; \
	$(MAKE) distfiles
	distdir=$(PACKAGE)-$(VERSION); \
	cd .disttmp; \
	tar -cvz > ../$$distdir.tar.gz $$distdir; \
	cd $$olddir
	rm -rf .disttmp

daily:
	olddir=`pwd`; \
	distdir=$(PACKAGE); \
	rm -rf .disttmp; \
	mkdir .disttmp; \
	mkdir .disttmp/$$distdir; \
	$(MAKE) dailyfiles
	day=`/bin/date +%Y%m%d`; \
	distdir=$(PACKAGE); \
	tarname=$$distdir-$$day ;\
	cd .disttmp; \
	perl -pi -e "s/\#DATE\#/$$day/g" $$distdir/yum-daily.spec; \
	echo $$day; \
	tar -cvz > ../$$tarname.tar.gz $$distdir; \
	cd $$olddir
	rm -rf .disttmp

dailyfiles:
	distdir=$(PACKAGE); \
	cp \
	$(srcdir)/*.py \
	$(srcdir)/AUTHORS \
	$(srcdir)/COPYING \
	$(srcdir)/INSTALL \
	$(srcdir)/README \
	$(srcdir)/TODO \
	$(srcdir)/ChangeLog \
	$(srcdir)/py-compile \
	$(srcdir)/Makefile.in \
	$(srcdir)/configure.in \
	$(srcdir)/configure \
	$(srcdir)/yum-daily.spec \
	$(srcdir)/install-sh \
	$(srcdir)/mkinstalldirs \
	$(top_srcdir)/.disttmp/$$distdir
	for subdir in $(SUBDIRS) ; do \
	  $(MAKE) -C $$subdir dailyfiles ; \
	done

distfiles:
	distdir=$(PACKAGE)-$(VERSION); \
	cp \
	$(srcdir)/*.py \
	$(srcdir)/AUTHORS \
	$(srcdir)/COPYING \
	$(srcdir)/INSTALL \
	$(srcdir)/README \
	$(srcdir)/TODO \
	$(srcdir)/ChangeLog \
	$(srcdir)/py-compile \
	$(srcdir)/Makefile.in \
	$(srcdir)/configure.in \
	$(srcdir)/configure \
	$(srcdir)/yum.spec \
	$(srcdir)/install-sh \
	$(srcdir)/mkinstalldirs \
	$(top_srcdir)/.disttmp/$$distdir
	for subdir in $(SUBDIRS) ; do \
	  $(MAKE) -C $$subdir distfiles ; \
	done

installdirs:
	$(srcdir)/mkinstalldirs $(DESTDIR)$(bindir) $(DESTDIR)/etc $(DESTDIR)$(pkgdatadir) $(DESTDIR)$(mandir)/man8 $(DESTDIR)$(mandir)/man5 $(DESTDIR)/var/cache/@PACKAGE@/

archive: dist


.PHONY: todo
todo:
	@echo ---------------===========================================
	@grep -n TODO\\\|FIXME `find . -type f` | grep -v grep
	@echo ---------------===========================================
.PHONY: all install install-strip uninstall clean distclean mostlyclean maintainer-clean info dvi dist distfiles check installcheck installdirs daily dailyfiles
